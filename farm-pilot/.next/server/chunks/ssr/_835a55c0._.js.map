{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/aliyusani/workspace/github.com/alisjj/Farm-Manager/farm-pilot/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,2JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,qIAAA,CAAA,OAAI,AAAD,EAAE;AACtB","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///home/aliyusani/workspace/github.com/alisjj/Farm-Manager/farm-pilot/lib/api.ts"],"sourcesContent":["// Lightweight API client for the frontend to talk to the backend\n// Uses NEXT_PUBLIC_API_URL or falls back to http://localhost:5001\n\nimport { \n  BackendHouse, \n  FrontendHousePayload, \n  House, \n  AuthCredentials, \n  FilterOptions,\n  HouseStatus \n} from '@/types';\n\nconst BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5001';\n\nfunction authHeader(): HeadersInit {\n  const token = typeof window !== 'undefined' ? localStorage.getItem('fm_token') : null;\n  return token ? { Authorization: `Bearer ${token}` } : {};\n}\n\nasync function tryRefreshToken(): Promise<boolean> {\n  try {\n    if (typeof window === 'undefined') return false;\n    try {\n      console.log('[api] tryRefreshToken start');\n    } catch {}\n    const refresh = localStorage.getItem('fm_refresh');\n    try {\n      console.log('[api] fm_refresh present?', !!refresh);\n    } catch {}\n    if (!refresh) return false;\n    const res = await fetch(`${BASE}/api/auth/refresh`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ refreshToken: refresh }),\n    });\n    if (!res.ok) return false;\n    const body = await res.json().catch(() => ({}));\n    const token = body?.token || body?.data?.token;\n    if (token) {\n      localStorage.setItem('fm_token', token);\n      try {\n        console.log('[api] tryRefreshToken stored new token');\n      } catch {}\n      authEvents.emit('refresh');\n      return true;\n    }\n    return false;\n  } catch {\n    return false;\n  }\n}\n\nasync function fetchWithAuth(input: RequestInfo | URL, init?: RequestInit, retry = true) {\n  // Normalize headers and attach Authorization header without unsafe casts\n  const headers = new Headers(init?.headers as HeadersInit | undefined);\n  const ah = authHeader();\n  Object.entries(ah).forEach(([k, v]) => {\n    if (v !== undefined && v !== null) headers.set(k, String(v));\n  });\n  const merged: RequestInit = { ...(init || {}), headers };\n  const res = await fetch(input, merged);\n  if (res.status === 401 && retry) {\n    const refreshed = await tryRefreshToken();\n    if (refreshed) {\n      const headers2 = new Headers(init?.headers as HeadersInit | undefined);\n      const ah2 = authHeader();\n      Object.entries(ah2).forEach(([k, v]) => {\n        if (v !== undefined && v !== null) headers2.set(k, String(v));\n      });\n      const retried: RequestInit = { ...(init || {}), headers: headers2 };\n      return fetch(input, retried);\n    }\n  }\n  return res;\n}\n\nasync function handleResponse(res: Response) {\n  if (!res.ok) {\n    const err = new Error(`HTTP ${res.status}`);\n    try {\n      const body = await res.json();\n      err.message = body?.message || err.message;\n    } catch {}\n    throw err;\n  }\n  return res.json().catch(() => ({}));\n}\n\n// Event emitter for auth events\nclass EventEmitter {\n  private events: Record<string, Function[]> = {};\n\n  emit(event: string, ...args: any[]) {\n    (this.events[event] || []).forEach((fn) => fn(...args));\n  }\n\n  on(event: string, fn: Function) {\n    this.events[event] = this.events[event] || [];\n    this.events[event].push(fn);\n  }\n\n  off(event: string, fn: Function) {\n    if (!this.events[event]) return;\n    this.events[event] = this.events[event].filter((f) => f !== fn);\n  }\n}\n\nexport const authEvents = new EventEmitter();\n\nfunction mapBackendHouse(house: BackendHouse): House {\n  return {\n    id: house.id,\n    name: house.houseName || house.name || 'Unknown',\n    capacity: Number(house.capacity) || 0,\n    currentBirds: Number(house.currentBirdCount) || 0,\n    location: house.location || 'N/A',\n    status:\n      house.status === 'active' || house.status === 'maintenance' || house.status === 'inactive'\n        ? house.status\n        : 'inactive',\n    notes: house.description,\n  };\n}\n\n// Daily Logs\nexport async function getDailyLogs(filters: Record<string, string> = {}) {\n  const params = new URLSearchParams(filters);\n  const res = await fetchWithAuth(`${BASE}/api/daily-logs?${params}`);\n  const data = await handleResponse(res);\n  return data;\n}\n\nexport async function createDailyLog(payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/daily-logs`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\n// Houses\nexport async function getHouses() {\n  const res = await fetchWithAuth(`${BASE}/api/houses`);\n  const data = await handleResponse(res);\n  return (data?.data || []).map(mapBackendHouse);\n}\n\nexport async function createHouse(payload: FrontendHousePayload) {\n  // map frontend shape -> backend expected fields\n  const body = {\n    name: payload.name,\n    capacity: payload.capacity,\n    currentBirds: payload.currentBirds,\n    location: payload.location,\n    status: payload.status,\n    notes: payload.notes,\n  };\n\n  const res = await fetchWithAuth(`${BASE}/api/houses`, {\n    method: 'POST',\n    headers: new Headers({ 'Content-Type': 'application/json' }),\n    body: JSON.stringify(body),\n  });\n\n  const data = await handleResponse(res);\n  return mapBackendHouse(data?.data);\n}\n\nexport async function updateHouse(id: string, payload: FrontendHousePayload) {\n  const body: Record<string, unknown> = {};\n  if (payload.name !== undefined) body.name = payload.name;\n  if (payload.capacity !== undefined) body.capacity = payload.capacity;\n  if (payload.currentBirds !== undefined) body.currentBirds = payload.currentBirds;\n  if (payload.location !== undefined) body.location = payload.location;\n  if (payload.status !== undefined) body.status = payload.status;\n  if (payload.notes !== undefined) body.notes = payload.notes;\n\n  const res = await fetchWithAuth(`${BASE}/api/houses/${id}`, {\n    method: 'PUT',\n    headers: new Headers({ 'Content-Type': 'application/json' }),\n    body: JSON.stringify(body),\n  });\n\n  const data = await handleResponse(res);\n  return mapBackendHouse(data?.data);\n}\n\nexport async function deleteHouse(id: string) {\n  const res = await fetchWithAuth(`${BASE}/api/houses/${id}`, {\n    method: 'DELETE',\n  });\n  return handleResponse(res);\n}\n\n// Auth\nexport async function login(credentials: { username: string; password: string }) {\n  const res = await fetch(`${BASE}/api/auth/login`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(credentials),\n  });\n  const data = await handleResponse(res);\n  if (data?.token) {\n    localStorage.setItem('fm_token', data.token);\n    if (data.refreshToken) {\n      localStorage.setItem('fm_refresh', data.refreshToken);\n    }\n    authEvents.emit('login');\n  }\n  return data;\n}\n\nexport async function logout() {\n  const refresh = localStorage.getItem('fm_refresh');\n  if (refresh) {\n    try {\n      await fetch(`${BASE}/api/auth/logout`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ refreshToken: refresh }),\n      });\n    } catch {}\n  }\n  localStorage.removeItem('fm_token');\n  localStorage.removeItem('fm_refresh');\n  authEvents.emit('logout');\n}\n\nexport async function getCurrentUser() {\n  try {\n    const res = await fetchWithAuth(`${BASE}/api/auth/me`);\n    if (res.status === 401) {\n      return null; // Let the caller handle auth errors gracefully\n    }\n    const data = await handleResponse(res);\n    return data?.user || data?.data || null;\n  } catch (error: any) {\n    if (error.message?.includes('401')) {\n      return null; // Return null for 401 errors instead of throwing\n    }\n    throw error;\n  }\n}\n\n// Staff\nexport async function listStaff() {\n  const res = await fetchWithAuth(`${BASE}/api/staff`);\n  return handleResponse(res);\n}\n\n// Laborers\nexport async function getLaborers() {\n  const res = await fetchWithAuth(`${BASE}/api/labor`);\n  return handleResponse(res);\n}\n\n// Sales\nexport async function getSales(filters: Record<string, string> = {}) {\n  const params = new URLSearchParams(filters);\n  const res = await fetchWithAuth(`${BASE}/api/sales?${params}`);\n  return handleResponse(res);\n}\n\nexport async function createSale(payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/sales`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\n// Customers\nexport async function getCustomers() {\n  const res = await fetchWithAuth(`${BASE}/api/customers`);\n  return handleResponse(res);\n}\n\nexport async function createCustomer(payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/customers`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\n// Reports\nexport async function getReports(type: string, filters: Record<string, string> = {}) {\n  const params = new URLSearchParams(filters);\n  const res = await fetchWithAuth(`${BASE}/api/reports/${type}?${params}`);\n  return handleResponse(res);\n}\n\n// Feed Management\nexport async function getFeedRecipes() {\n  const res = await fetchWithAuth(`${BASE}/api/feed/recipes`);\n  return handleResponse(res);\n}\n\nexport async function createFeedRecipe(payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/recipes`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\nexport async function updateFeedRecipe(id: string, payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/recipes/${id}`, {\n    method: 'PUT',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\nexport async function deleteFeedRecipe(id: string) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/recipes/${id}`, {\n    method: 'DELETE',\n  });\n  return handleResponse(res);\n}\n\nexport async function getFeedBatches(filters: Record<string, string> = {}) {\n  const params = new URLSearchParams(filters);\n  const res = await fetchWithAuth(`${BASE}/api/feed/batches?${params}`);\n  return handleResponse(res);\n}\n\nexport async function createFeedBatch(payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/batches`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\nexport async function updateFeedBatch(id: string, payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/batches/${id}`, {\n    method: 'PUT',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\nexport async function deleteFeedBatch(id: string) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/batches/${id}`, {\n    method: 'DELETE',\n  });\n  return handleResponse(res);\n}\n\nexport async function getBatchIngredients(batchId: string) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/batches/${batchId}/ingredients`);\n  return handleResponse(res);\n}\n\nexport async function addBatchIngredient(batchId: string, payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/batches/${batchId}/ingredients`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\nexport async function estimateBatchCost(payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/batches/estimate`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n\nexport async function calculateFeedBatchCost(payload: any) {\n  const res = await fetchWithAuth(`${BASE}/api/feed/batches/calculate-cost`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  return handleResponse(res);\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 400, "column": 0}, "map": {"version":3,"sources":["file:///home/aliyusani/workspace/github.com/alisjj/Farm-Manager/farm-pilot/lib/authEvents.ts"],"sourcesContent":["type AuthEvent = \"login\" | \"refresh\" | \"logout\";\n\nconst listeners: Record<AuthEvent, Set<() => void>> = {\n  login: new Set(),\n  refresh: new Set(),\n  logout: new Set(),\n};\n\nexport const authEvents = {\n  on(event: AuthEvent, cb: () => void) {\n    listeners[event].add(cb);\n  },\n  off(event: AuthEvent, cb: () => void) {\n    listeners[event].delete(cb);\n  },\n  emit(event: AuthEvent) {\n    listeners[event].forEach((cb) => {\n      try {\n        cb();\n      } catch (e) {\n        // swallow listener errors\n        console.error(\"authEvents listener error\", e);\n      }\n    });\n  },\n};\n"],"names":[],"mappings":";;;AAEA,MAAM,YAAgD;IACpD,OAAO,IAAI;IACX,SAAS,IAAI;IACb,QAAQ,IAAI;AACd;AAEO,MAAM,aAAa;IACxB,IAAG,KAAgB,EAAE,EAAc;QACjC,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC;IACvB;IACA,KAAI,KAAgB,EAAE,EAAc;QAClC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC;IAC1B;IACA,MAAK,KAAgB;QACnB,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACxB,IAAI;gBACF;YACF,EAAE,OAAO,GAAG;gBACV,0BAA0B;gBAC1B,QAAQ,KAAK,CAAC,6BAA6B;YAC7C;QACF;IACF;AACF","debugId":null}},
    {"offset": {"line": 432, "column": 0}, "map": {"version":3,"sources":["file:///home/aliyusani/workspace/github.com/alisjj/Farm-Manager/farm-pilot/context/UserContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useRef, useState } from 'react';\nimport { getCurrentUser, logout as apiLogout } from '@/lib/api';\nimport { authEvents } from '@/lib/authEvents';\n\ntype User = {\n  id: string;\n  username: string;\n  role: 'owner' | 'staff';\n  email?: string;\n};\n\ntype ContextValue = {\n  user: User | null;\n  loading: boolean;\n  refresh: () => Promise<boolean>;\n  logout: () => void;\n};\n\nconst UserContext = createContext<ContextValue | undefined>(undefined);\n\nexport const UserProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n  const fetchInFlight = useRef(false);\n  const hasInitialized = useRef(false);\n\n  const fetchUser = async (): Promise<boolean> => {\n    if (fetchInFlight.current) {\n      try {\n        console.log('[auth] fetchUser skipped because already in-flight');\n      } catch {}\n      return false;\n    }\n    fetchInFlight.current = true;\n    setLoading(true);\n    try {\n      try {\n        console.log('[auth] fetchUser start');\n      } catch {}\n      const u = await getCurrentUser();\n      try {\n        console.log('[auth] fetchUser got', u);\n      } catch {}\n      if (u) {\n        setUser({\n          id: String(u.id),\n          username: String(u.username),\n          role: u.role === 'owner' ? 'owner' : 'staff',\n          email: u.email,\n        });\n        return true;\n      } else {\n        setUser(null);\n        return false;\n      }\n    } catch (error) {\n      try {\n        console.log('[auth] fetchUser error', error);\n      } catch {}\n      setUser(null);\n      return false;\n    } finally {\n      fetchInFlight.current = false;\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    // Prevent multiple initializations\n    if (hasInitialized.current) return;\n    hasInitialized.current = true;\n\n    fetchUser();\n    // subscribe to auth events so we react centrally\n    const onLogin = () => void fetchUser();\n    const onRefresh = () => void fetchUser();\n    const onLogout = () => {\n      try {\n        console.log('[authEvents] logout received');\n      } catch {}\n      setUser(null);\n      // Remove the automatic redirect to prevent loops\n      // The UI should handle showing login form when user is null\n    };\n    try {\n      console.log('[auth] subscribing to authEvents');\n    } catch {}\n    authEvents.on('login', onLogin);\n    authEvents.on('refresh', onRefresh);\n    authEvents.on('logout', onLogout);\n    return () => {\n      authEvents.off('login', onLogin);\n      authEvents.off('refresh', onRefresh);\n      authEvents.off('logout', onLogout);\n    };\n  }, []);\n\n  const handleLogout = () => {\n    apiLogout();\n    setUser(null);\n    // Remove automatic redirect - let the UI handle showing login form\n  };\n\n  return (\n    <UserContext.Provider value={{ user, loading, refresh: fetchUser, logout: handleLogout }}>\n      {children}\n    </UserContext.Provider>\n  );\n};\n\nexport function useUser() {\n  const ctx = useContext(UserContext);\n  if (!ctx) throw new Error('useUser must be used within UserProvider');\n  return ctx;\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAgBA,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,gBAAa,AAAD,EAA4B;AAErD,MAAM,eAAwD,CAAC,EAAE,QAAQ,EAAE;IAChF,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAe;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,gBAAgB,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAE;IAC7B,MAAM,iBAAiB,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAE;IAE9B,MAAM,YAAY;QAChB,IAAI,cAAc,OAAO,EAAE;YACzB,IAAI;gBACF,QAAQ,GAAG,CAAC;YACd,EAAE,OAAM,CAAC;YACT,OAAO;QACT;QACA,cAAc,OAAO,GAAG;QACxB,WAAW;QACX,IAAI;YACF,IAAI;gBACF,QAAQ,GAAG,CAAC;YACd,EAAE,OAAM,CAAC;YACT,MAAM,IAAI,MAAM,CAAA,GAAA,0GAAA,CAAA,iBAAc,AAAD;YAC7B,IAAI;gBACF,QAAQ,GAAG,CAAC,wBAAwB;YACtC,EAAE,OAAM,CAAC;YACT,IAAI,GAAG;gBACL,QAAQ;oBACN,IAAI,OAAO,EAAE,EAAE;oBACf,UAAU,OAAO,EAAE,QAAQ;oBAC3B,MAAM,EAAE,IAAI,KAAK,UAAU,UAAU;oBACrC,OAAO,EAAE,KAAK;gBAChB;gBACA,OAAO;YACT,OAAO;gBACL,QAAQ;gBACR,OAAO;YACT;QACF,EAAE,OAAO,OAAO;YACd,IAAI;gBACF,QAAQ,GAAG,CAAC,0BAA0B;YACxC,EAAE,OAAM,CAAC;YACT,QAAQ;YACR,OAAO;QACT,SAAU;YACR,cAAc,OAAO,GAAG;YACxB,WAAW;QACb;IACF;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,mCAAmC;QACnC,IAAI,eAAe,OAAO,EAAE;QAC5B,eAAe,OAAO,GAAG;QAEzB;QACA,iDAAiD;QACjD,MAAM,UAAU,IAAM,KAAK;QAC3B,MAAM,YAAY,IAAM,KAAK;QAC7B,MAAM,WAAW;YACf,IAAI;gBACF,QAAQ,GAAG,CAAC;YACd,EAAE,OAAM,CAAC;YACT,QAAQ;QACR,iDAAiD;QACjD,4DAA4D;QAC9D;QACA,IAAI;YACF,QAAQ,GAAG,CAAC;QACd,EAAE,OAAM,CAAC;QACT,iHAAA,CAAA,aAAU,CAAC,EAAE,CAAC,SAAS;QACvB,iHAAA,CAAA,aAAU,CAAC,EAAE,CAAC,WAAW;QACzB,iHAAA,CAAA,aAAU,CAAC,EAAE,CAAC,UAAU;QACxB,OAAO;YACL,iHAAA,CAAA,aAAU,CAAC,GAAG,CAAC,SAAS;YACxB,iHAAA,CAAA,aAAU,CAAC,GAAG,CAAC,WAAW;YAC1B,iHAAA,CAAA,aAAU,CAAC,GAAG,CAAC,UAAU;QAC3B;IACF,GAAG,EAAE;IAEL,MAAM,eAAe;QACnB,CAAA,GAAA,0GAAA,CAAA,SAAS,AAAD;QACR,QAAQ;IACR,mEAAmE;IACrE;IAEA,qBACE,8OAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAS,SAAS;YAAW,QAAQ;QAAa;kBACpF;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,MAAM,CAAA,GAAA,qMAAA,CAAA,aAAU,AAAD,EAAE;IACvB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,OAAO;AACT","debugId":null}},
    {"offset": {"line": 548, "column": 0}, "map": {"version":3,"sources":["file:///home/aliyusani/workspace/github.com/alisjj/Farm-Manager/farm-pilot/app/page.tsx"],"sourcesContent":["'use client';\n\nimport type React from 'react';\n\nimport { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Input } from '@/components/ui/input';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { cn } from '@/lib/utils';\nimport { login as apiLogin, logout as apiLogout } from '@/lib/api';\nimport { useUser } from '@/context/UserContext';\nimport {\n  BarChart3,\n  Egg,\n  Users,\n  TrendingUp,\n  Calendar,\n  Package,\n  Plus,\n  Settings,\n  Bell,\n  Search,\n  UserCheck,\n  BarChart2,\n  Menu,\n  X,\n  Receipt,\n  Lock,\n} from 'lucide-react';\nimport { DashboardOverview } from '@/components/dashboard-overview';\nimport { DailyEntryForm } from '@/components/daily-entry-form';\nimport { SalesManagement } from '@/components/sales-management';\nimport { FeedManagement } from '@/components/feed-management';\nimport { LaborManagement } from '@/components/labor-management';\nimport { CostAnalysis } from '@/components/cost-analysis';\nimport { ReportsSection } from '@/components/reports-section';\nimport { StaffDashboard } from '@/components/staff-dashboard';\nimport { StaffReports } from '@/components/staff-reports';\nimport { StaffManagement } from '@/components/staff-management';\nimport { ExpenseManagement } from '@/components/expense-management';\nimport { StaffDailyEntry } from '@/components/staff-daily-entry';\nimport { HouseManagement } from '@/components/house-management';\nimport { UserProvider } from '@/context/UserContext';\n\nexport default function FarmPilot() {\n  return (\n    <UserProvider>\n      <FarmPilotApp />\n    </UserProvider>\n  );\n}\n\nfunction FarmPilotApp() {\n  const { user, loading } = useUser();\n  const [activeTab, setActiveTab] = useState('dashboard');\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  // Determine user role from the context\n  const userRole = user?.role || 'staff';\n\n  function LoginShell() {\n    const { refresh } = useUser();\n    const [loginForm, setLoginForm] = useState({ username: '', password: '' });\n    const [loginLoading, setLoginLoading] = useState(false);\n\n    const handleLoginInner = async (e: React.FormEvent) => {\n      e.preventDefault();\n      // debug: trace login submission\n      try {\n        console.log('[auth] handleLoginInner start', {\n          username: loginForm.username ? '***' : '',\n          ts: Date.now(),\n        });\n      } catch {}\n      setLoginLoading(true);\n      try {\n        const res = await apiLogin({ username: loginForm.username, password: loginForm.password });\n        try {\n          console.log('[auth] apiLogin response', res);\n        } catch {}\n        if (res && res.success && res.data && res.data.user) {\n          const ok = await refresh();\n          if (ok) {\n            console.log('[auth] logged in', res.data.user);\n          } else {\n            alert('Login succeeded but user fetch failed. Please try again.');\n          }\n        } else {\n          const msg = (res && (res.message || res.error)) || 'Invalid credentials';\n          alert(msg);\n        }\n      } catch (err) {\n        console.error('Login failed', err);\n        const maybeErr = err as Record<string, unknown>;\n        const msg =\n          (err &&\n            typeof err === 'object' &&\n            typeof maybeErr.message === 'string' &&\n            maybeErr.message) ||\n          'Login failed';\n        alert(msg);\n      } finally {\n        setLoginLoading(false);\n      }\n    };\n\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-cyan-50 to-purple-50 flex items-center justify-center p-4\">\n        <Card className=\"w-full max-w-md\">\n          <CardHeader className=\"text-center space-y-4\">\n            <div className=\"mx-auto h-16 w-16 rounded-full bg-primary flex items-center justify-center\">\n              <Egg className=\"h-8 w-8 text-primary-foreground\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-2xl font-bold text-balance\">\n                Welcome to Farm Pilot\n              </CardTitle>\n              <CardDescription className=\"text-balance\">\n                Sign in to manage your egg production operations\n              </CardDescription>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleLoginInner} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <label htmlFor=\"username\" className=\"text-sm font-medium\">\n                  Username\n                </label>\n                <Input\n                  id=\"username\"\n                  type=\"text\"\n                  placeholder=\"Enter your username\"\n                  value={loginForm.username}\n                  onChange={(e) => setLoginForm({ ...loginForm, username: e.target.value })}\n                  required\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <label htmlFor=\"password\" className=\"text-sm font-medium\">\n                  Password\n                </label>\n                <Input\n                  id=\"password\"\n                  type=\"password\"\n                  placeholder=\"Enter your password\"\n                  value={loginForm.password}\n                  onChange={(e) => setLoginForm({ ...loginForm, password: e.target.value })}\n                  required\n                />\n              </div>\n              <Button type=\"submit\" className=\"w-full\" disabled={loginLoading}>\n                {loginLoading ? (\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent\" />\n                    Signing in...\n                  </div>\n                ) : (\n                  <div className=\"flex items-center gap-2\">\n                    <Lock className=\"h-4 w-4\" />\n                    Sign In\n                  </div>\n                )}\n              </Button>\n            </form>\n            <div className=\"mt-6 text-center text-sm text-muted-foreground\">\n              <p>Please sign in with your account credentials.</p>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const handleLogout = () => {\n    apiLogout();\n    setActiveTab('dashboard');\n    console.log('[auth] User logged out');\n  };\n\n  // Show loading while checking authentication\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div>Loading...</div>\n      </div>\n    );\n  }\n\n  // Show login form if not authenticated\n  if (!user) {\n    return <LoginShell />;\n  }\n\n  const ownerNavItems = [\n    { id: 'dashboard', label: 'Dashboard', icon: BarChart3 },\n    { id: 'daily-entry', label: 'Daily Entry', icon: Plus },\n    {\n      id: 'sales',\n      label: 'Sales',\n      icon: () => <span className=\"text-sm font-bold\">â‚¦</span>,\n    },\n    { id: 'feed', label: 'Feed Management', icon: Package },\n    { id: 'houses', label: 'House Management', icon: Egg },\n    { id: 'labor', label: 'Labor', icon: Users },\n    { id: 'staff', label: 'Staff Management', icon: UserCheck },\n    { id: 'expenses', label: 'Expenses', icon: Receipt },\n    { id: 'costs', label: 'Cost Analysis', icon: TrendingUp },\n    { id: 'reports', label: 'Reports', icon: Calendar },\n  ];\n\n  const renderOwnerContent = () => {\n    switch (activeTab) {\n      case 'dashboard':\n        return <DashboardOverview />;\n      case 'daily-entry':\n        return <DailyEntryForm />;\n      case 'sales':\n        return <SalesManagement />;\n      case 'feed':\n        return <FeedManagement />;\n      case 'houses':\n        return <HouseManagement />;\n      case 'labor':\n        return <LaborManagement />;\n      case 'staff':\n        return <StaffManagement />;\n      case 'expenses':\n        return <ExpenseManagement />;\n      case 'costs':\n        return <CostAnalysis />;\n      case 'reports':\n        return <ReportsSection />;\n      default:\n        return <DashboardOverview />;\n    }\n  };\n\n  const renderStaffTabs = () => (\n    <>\n      <TabsList className=\"grid w-full grid-cols-4 lg:w-auto lg:grid-cols-none lg:flex\">\n        <TabsTrigger value=\"dashboard\" className=\"flex items-center gap-2\">\n          <BarChart2 className=\"h-4 w-4\" />\n          <span className=\"hidden sm:inline\">Dashboard</span>\n        </TabsTrigger>\n        <TabsTrigger value=\"daily-entry\" className=\"flex items-center gap-2\">\n          <Plus className=\"h-4 w-4\" />\n          <span className=\"hidden sm:inline\">Daily Log</span>\n        </TabsTrigger>\n        <TabsTrigger value=\"expenses\" className=\"flex items-center gap-2\">\n          <Receipt className=\"h-4 w-4\" />\n          <span className=\"hidden sm:inline\">Expenses</span>\n        </TabsTrigger>\n        <TabsTrigger value=\"reports\" className=\"flex items-center gap-2\">\n          <Calendar className=\"h-4 w-4\" />\n          <span className=\"hidden sm:inline\">Reports</span>\n        </TabsTrigger>\n      </TabsList>\n\n      <TabsContent value=\"dashboard\" className=\"space-y-6\">\n        <StaffDashboard />\n      </TabsContent>\n      <TabsContent value=\"daily-entry\" className=\"space-y-6\">\n        <StaffDailyEntry />\n      </TabsContent>\n      <TabsContent value=\"expenses\" className=\"space-y-6\">\n        <ExpenseManagement userRole=\"staff\" />\n      </TabsContent>\n      <TabsContent value=\"reports\" className=\"space-y-6\">\n        <StaffReports />\n      </TabsContent>\n    </>\n  );\n\n  if (userRole === 'staff') {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        {/* Header */}\n        <header className=\"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n          <div className=\"container flex h-16 items-center justify-between px-4\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"h-8 w-8 rounded-lg bg-primary flex items-center justify-center\">\n                  <Egg className=\"h-5 w-5 text-primary-foreground\" />\n                </div>\n                <h1 className=\"text-xl font-bold text-balance\">Farm Pilot</h1>\n              </div>\n              <Badge variant=\"secondary\" className=\"hidden sm:inline-flex\">\n                v2.0\n              </Badge>\n              <Badge variant=\"outline\" className=\"hidden sm:inline-flex\">\n                Staff\n              </Badge>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Button variant=\"ghost\" size=\"icon\">\n                <Search className=\"h-4 w-4\" />\n              </Button>\n              <Button variant=\"ghost\" size=\"icon\">\n                <Bell className=\"h-4 w-4\" />\n              </Button>\n              <Button variant=\"ghost\" size=\"icon\" onClick={handleLogout}>\n                <Settings className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </div>\n        </header>\n\n        {/* Main Content */}\n        <div className=\"container mx-auto px-4 py-6\">\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n            {renderStaffTabs()}\n          </Tabs>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n        <div className=\"flex h-16 items-center justify-between px-4\">\n          <div className=\"flex items-center gap-4\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"lg:hidden\"\n              onClick={() => setSidebarOpen(!sidebarOpen)}\n            >\n              {sidebarOpen ? <X className=\"h-4 w-4\" /> : <Menu className=\"h-4 w-4\" />}\n            </Button>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"h-8 w-8 rounded-lg bg-primary flex items-center justify-center\">\n                <Egg className=\"h-5 w-5 text-primary-foreground\" />\n              </div>\n              <h1 className=\"text-xl font-bold text-balance\">Farm Pilot</h1>\n            </div>\n            <Badge variant=\"secondary\" className=\"hidden sm:inline-flex\">\n              v2.0\n            </Badge>\n            <Badge variant=\"default\" className=\"hidden sm:inline-flex\">\n              Owner\n            </Badge>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <Button variant=\"ghost\" size=\"icon\">\n              <Search className=\"h-4 w-4\" />\n            </Button>\n            <Button variant=\"ghost\" size=\"icon\">\n              <Bell className=\"h-4 w-4\" />\n            </Button>\n            <Button variant=\"ghost\" size=\"icon\" onClick={handleLogout}>\n              <Settings className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"flex\">\n        {/* Sidebar */}\n        <aside\n          className={cn(\n            'fixed top-16 left-0 z-40 w-64 h-[calc(100vh-4rem)] transform border-r bg-background transition-transform duration-200 ease-in-out lg:relative lg:translate-x-0 lg:top-0 lg:h-[calc(100vh-4rem)]',\n            sidebarOpen ? 'translate-x-0' : '-translate-x-full'\n          )}\n        >\n          <div className=\"flex h-full flex-col overflow-hidden\">\n            <nav className=\"flex-1 space-y-1 p-4 overflow-y-auto\">\n              {ownerNavItems.map((item) => {\n                const Icon = item.icon as React.ElementType;\n                return (\n                  <button\n                    key={item.id}\n                    onClick={() => {\n                      setActiveTab(item.id);\n                      setSidebarOpen(false);\n                    }}\n                    className={cn(\n                      'flex w-full items-center gap-3 rounded-lg px-3 py-2 text-left text-sm font-medium transition-colors',\n                      activeTab === item.id\n                        ? 'bg-primary text-primary-foreground'\n                        : 'text-muted-foreground hover:bg-accent hover:text-accent-foreground'\n                    )}\n                  >\n                    <Icon className=\"h-4 w-4\" />\n                    {item.label}\n                  </button>\n                );\n              })}\n            </nav>\n          </div>\n        </aside>\n\n        {/* Overlay for mobile */}\n        {sidebarOpen && (\n          <div\n            className=\"fixed inset-0 z-30 bg-background/80 backdrop-blur-sm lg:hidden\"\n            onClick={() => setSidebarOpen(false)}\n          />\n        )}\n\n        {/* Main Content */}\n        <main className=\"flex-1 lg:ml-0\">\n          <div className=\"h-[calc(100vh-4rem)] overflow-auto p-6\">{renderOwnerContent()}</div>\n        </main>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}